<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Prepare gene sets for hitype"><title>Prepare gene sets for hitype — gs_prepare • hitype</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare gene sets for hitype — gs_prepare"><meta property="og:description" content="Prepare gene sets for hitype"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hitype</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/prepare-gene-sets.html">Prepare gene sets</a>
    <a class="dropdown-item" href="../articles/calculate-cell-type-scores-and-assign-cell-types.html">Assign cell types</a>
    <a class="dropdown-item" href="../articles/train-marker-weights.html">Train marker weights</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/hitype-is-faster.html">Hitype is faster</a>
    <a class="dropdown-item" href="../articles/marker-weights-improves-results.html">Hitype is more accurate</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepare gene sets for hitype</h1>
      
      <div class="d-none name"><code>gs_prepare.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Prepare gene sets for hitype</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gs_prepare</span><span class="op">(</span><span class="va">path_to_db_file</span>, tissue_type <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>path_to_db_file</dt>
<dd><p>A data frame with markers or
Path to the marker gene database file, it should be
a tab-delimited text or excel file with the following columns:</p><ul><li><p><code>tissueType</code>: The tissue type of the cell type to be annotated.
This column is required only if <code>cell_type</code> is specified.</p></li>
<li><p><code>cellName</code>: The name of the cell type to be annotated.</p></li>
<li><p><code>nextLevels</code>: Possible next levels of the cell type to be annotated.
Introduced by <code>hitype</code>, so that we can work with hierarchical cell.
Levels are separated by <code>;</code>. Cell names at each level are separated
by <code>,</code>. An exclamatory mark <code>!</code> at the beginning of a level means
that the cell names at this level are mutually exclusive. If the
levels are less than possible next levels, then the remaining levels
are all possible next levels. See the example below.</p></li>
<li><p><code>geneSymbolmore1</code>: The gene symbols of the marker genes that are
expected to be expressed in the cell type to be annotated.
The genes can be suffixed with one or more <code>+</code>. More <code>+</code> means
higher expression level. For example, <code>CD3E++</code> means the gene
<code>CD3E</code> is expected to be highly expressed in the cell type.</p></li>
<li><p><code>geneSymbolmore2</code>: The gene symbols of the marker genes that are
expected not to be expressed in the cell type to be annotated.</p></li>
<li><p><code>level</code>: The levels of the cell names. Introduced by <code>hitype</code>, so that
we can work with hierarchical cell names. Different levels of
<code>cellName</code>s are predicted separately. For example, If we have <code>CD4</code>
as level 1 and <code>Naive</code> as level 2, then our prediction for a cell type
could be <code>CD4 Naive</code>.
The levels should start from 1 and be consecutive. #'</p></li>
</ul></dd>


<dt>tissue_type</dt>
<dd><p>The tissue type of the cell type to be annotated.
This requires the <code>tissueType</code> column in the marker gene database file.
If <code>tissue_type</code> is specified, then only the cell types in the specified
tissue type will be used for annotation. If <code>tissue_type</code> is not specified,
then all cell types in the marker gene database file will be used for
annotation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with gene_sets and next_levels. The structure looks like:</p>


<p></p><div class="sourceCode r"><pre><code><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     gene_sets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>         <span class="co"># level 1</span></span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> CD4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span> <span class="op">)</span>,</span>
<span>         <span class="co"># level 2</span></span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> Naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span> <span class="op">)</span></span>
<span>     <span class="op">)</span>,</span>
<span>     <span class="co"># All possible final cell names</span></span>
<span>     cell_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>CD4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Activated"</span>, <span class="st">"Proliferating"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>


    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matt Mulvahill, Panwen Wang</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># nextLevels example</span></span></span>
<span class="r-in"><span><span class="co"># If we have the following cell types:</span></span></span>
<span class="r-in"><span><span class="co">#   level  cellName  nextLevels</span></span></span>
<span class="r-in"><span><span class="co">#   1      CD4       Naive,Memory</span></span></span>
<span class="r-in"><span><span class="co">#   2      Naive</span></span></span>
<span class="r-in"><span><span class="co">#   2      Memory</span></span></span>
<span class="r-in"><span><span class="co">#   3      Activated</span></span></span>
<span class="r-in"><span><span class="co">#   3      Proliferating</span></span></span>
<span class="r-in"><span><span class="co"># Then possible final cell names are:</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Naive Activated</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Naive Proliferating</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Memory Activated</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Memory Proliferating</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># If the `nextLevels` of CD4 is `!Naive`, then possible final cell names are:</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Memory Activated</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Memory Proliferating</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># If the `nextLevels` of CD4 is `!`, then possible final cell names are:</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Activated</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Proliferating</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># If the `nextLevels` of CD4 is `!Naive;!`, then possible final cell names</span></span></span>
<span class="r-in"><span><span class="co"># are:</span></span></span>
<span class="r-in"><span><span class="co">#   CD4 Memory</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Panwen Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

