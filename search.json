[{"path":"https://pwwang.github.io/hitype/articles/calculate-cell-type-scores-and-assign-cell-types.html","id":"using-runhitype-on-seurat-object","dir":"Articles","previous_headings":"","what":"Using RunHitype on Seurat object","title":"Calculate cell type scores and assign cell types","text":"Prepare seurat object: See also https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#setup--seurat-object  Compared manual marked cell types: Seurat manual marked cell types See also https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#assigning-cell-type-identity--clusters","code":"suppressWarnings(SeuratData::InstallData(\"pbmc3k\")) pbmc <- pbmc3k.SeuratData::pbmc3k pbmc[[\"percent.mt\"]] <- Seurat::PercentageFeatureSet(pbmc, pattern = \"^MT-\") pbmc <- subset(pbmc, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5) pbmc <- Seurat::NormalizeData(pbmc) pbmc <- Seurat::FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000) pbmc <- Seurat::ScaleData(pbmc, features = rownames(pbmc)) pbmc <- Seurat::RunPCA(pbmc, features = Seurat::VariableFeatures(object = pbmc)) pbmc <- Seurat::FindNeighbors(pbmc, dims = 1:10) pbmc <- Seurat::FindClusters(pbmc, resolution = 0.5) #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 2638 #> Number of edges: 95927 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8728 #> Number of communities: 9 #> Elapsed time: 0 seconds pbmc <- Seurat::RunUMAP(pbmc, dims = 1:10) library(hitype)  # Load gene sets gs <- gs_prepare(hitypedb_pbmc3k)  # Assign cell types obj <- RunHitype(pbmc, gs)  Seurat::DimPlot(obj, group.by = \"hitype\", label = TRUE, label.box = TRUE) +   Seurat::NoLegend()"},{"path":"https://pwwang.github.io/hitype/articles/calculate-cell-type-scores-and-assign-cell-types.html","id":"using-hitype_score-and-hitype_assign-on-seurat-directly","dir":"Articles","previous_headings":"","what":"Using hitype_score and hitype_assign on Seurat directly","title":"Calculate cell type scores and assign cell types","text":"compare manual marked cell types: See: https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#assigning-cell-type-identity--clusters","code":"scores <- hitype_score(pbmc@assays$RNA@scale.data, gs, scaled = TRUE) cell_types <- hitype_assign(pbmc$seurat_clusters, scores, gs) summary(cell_types) #> # A tibble: 9 × 4 #>   Level Cluster CellType     Score #>   <int> <fct>   <chr>        <dbl> #> 1     1 0       Naive CD4+ T 0.104 #> 2     1 1       CD14+ Mono   0.162 #> 3     1 2       Memory CD4+  0.114 #> 4     1 3       B            0.139 #> 5     1 4       CD8+ T       0.190 #> 6     1 5       FCFR3A+ Mono 0.366 #> 7     1 6       NK           0.256 #> 8     1 7       DC           0.559 #> 9     1 8       Platelet     0.973"},{"path":"https://pwwang.github.io/hitype/articles/calculate-cell-type-scores-and-assign-cell-types.html","id":"exploring-the-result-of-hitype_assign","dir":"Articles","previous_headings":"","what":"Exploring the result of hitype_assign","title":"Calculate cell type scores and assign cell types","text":"result hitype_assign data.frame following columns: Level: level cell type hierarchy Cluster: cluster ID CellType: cell type name Score: score cell type","code":"head(cell_types) #> # A tibble: 1 × 4 #>   Level Cluster CellType     Score #>   <int> <fct>   <chr>        <dbl> #> 1     1 0       Naive CD4+ T 0.104"},{"path":"https://pwwang.github.io/hitype/articles/prepare-gene-sets.html","id":"using-gene-sets-from-sctype1","dir":"Articles","previous_headings":"","what":"Using gene sets from ScType","title":"Prepare gene sets","text":"hitype designed compatible ScType. gene sets provided ScType can used directly. two gene sets now also built hitype:","code":"library(hitype) #> The legacy packages maptools, rgdal, and rgeos, underpinning the sp package, #> which was just loaded, will retire in October 2023. #> Please refer to R-spatial evolution reports for details, especially #> https://r-spatial.org/r/2023/05/15/evolution4.html. #> It may be desirable to make the sf package available; #> package maintainers should consider adding sf to Suggests:. #> The sp package is now running under evolution status 2 #>      (status 2 uses the sf package in place of rgdal)  gs <- gs_prepare(   \"https://raw.githubusercontent.com/IanevskiAleksandr/sc-type/master/ScTypeDB_short.xlsx\" ) gs$gene_sets[[1]]$`Acinar cells` #> $markers #>  [1] \"CTRB1\"    \"KLK1\"     \"RBPJL\"    \"PTF1A\"    \"CELA3A\"   \"PRSS1\"    #>  [7] \"SPINK1\"   \"ZG16\"     \"CEL\"      \"CELA2A\"   \"CPB1\"     \"CELA1\"    #> [13] \"RNASE1\"   \"AMY2B\"    \"CPA2\"     \"CPA1\"     \"CELA3B\"   \"PNLIP\"    #> [19] \"CTRB2\"    \"PLA2G1B\"  \"PRSS2\"    \"CLPS\"     \"REG1A\"    \"SYCN\"     #> [25] \"PNLIPRP1\" \"CTRC\"     \"REG3A\"    \"PRSS3\"    \"REG1B\"    \"CFB\"      #> [31] \"GDF15\"    \"MUC1\"     \"C15orf48\" \"AKR1C3\"   \"OLFM4\"    \"GSTA1\"    #> [37] \"LGALS2\"   \"PDZK1IP1\" \"RARRES2\"  \"CXCL17\"   \"GSTA2\"    \"ANPEP\"    #> [43] \"LYZ\"      \"ANGPTL4\"  \"ALDOB\"    #>  #> $weights #>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 #> [39] 1 1 1 1 1 1 1  # gs <- gs_prepare( #  \"https://raw.githubusercontent.com/IanevskiAleksandr/sc-type/master/ScTypeDB_long.xlsx\" # ) # gs <- gs_prepare(hitypedb_short) # gs <- gs_prepare(hitypedb_full)"},{"path":"https://pwwang.github.io/hitype/articles/prepare-gene-sets.html","id":"built-in-gene-sets","dir":"Articles","previous_headings":"","what":"Built-in gene sets","title":"Prepare gene sets","text":"hitype also provides built-gene sets:","code":""},{"path":"https://pwwang.github.io/hitype/articles/prepare-gene-sets.html","id":"gene-sets-from-sctype_short","dir":"Articles","previous_headings":"Built-in gene sets","what":"Gene sets from ScType_short","title":"Prepare gene sets","text":"","code":"head(hitypedb_short) #>      tissueType         cellName #> 1 Immune system      Pro-B cells #> 2 Immune system      Pre-B cells #> 3 Immune system Immature B cells #> 4 Immune system    Naive B cells #> 5 Immune system   Memory B cells #> 6 Immune system   Plasma B cells #>                                                                                                                                                              geneSymbolmore1 #> 1                                       CD27,IgD,CD24,PTPRC,PAX5,CD24,CD38,CD79A,DNTT,C10orf10,VPREB1,ARPP21,CD99,IGLL1,CD9,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,VPREB3,IGLL5 #> 2                                            CD19,CD27,IgD,CD24,PTPRC,PAX5,CD24,CD38,CD79A,NSMCE1,PCDH9,ACSM3,CCDC191,TCL1A,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,VPREB3,IGLL5 #> 3                                                CD19,CD27,IgD,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,CXCL8,S100A12,LYZ,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,VPREB3,IGLL5 #> 4           CD19,IgD,CD38,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,JCHAIN,SSR4,FKBP11,SEC11C,DERL3,PRDX4,IGLL5,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,CD138,CD38,VPREB3,IGLL5 #> 5 CD19,CD27,IgD,CD38,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,JCHAIN,SSR4,FKBP11,SEC11C,DERL3,PRDX4,IGLL5,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,CD138,CD38,CD27,VPREB3,IGLL5 #> 6      CD19,CD27,IgD,CD38,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,JCHAIN,SSR4,FKBP11,SEC11C,DERL3,PRDX4,IGLL5,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,CD138,CD38,VPREB3,IGLL5 #>   geneSymbolmore2 #> 1            <NA> #> 2            <NA> #> 3            <NA> #> 4            CD27 #> 5            <NA> #> 6      CD20,MS4A1"},{"path":"https://pwwang.github.io/hitype/articles/prepare-gene-sets.html","id":"gene-sets-from-sctype_full","dir":"Articles","previous_headings":"Built-in gene sets","what":"Gene sets from ScType_full","title":"Prepare gene sets","text":"","code":"head(hitypedb_full) #>      tissueType           cellName #> 1 Immune system        Pro-B cells #> 2 Immune system        Pre-B cells #> 3 Immune system      Naive B cells #> 4 Immune system     Memory B cells #> 5 Immune system     Plasma B cells #> 6 Immune system Naive CD8+ T cells #>                                                                                                                                                                     geneSymbolmore1 #> 1                                              CD27,IgD,CD24,PTPRC,PAX5,CD24,CD38,CD79A,DNTT,C10orf10,VPREB1,ARPP21,CD99,IGLL1,CD9,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,VPREB3,IGLL5 #> 2                                                   CD19,CD27,IgD,CD24,PTPRC,PAX5,CD24,CD38,CD79A,NSMCE1,PCDH9,ACSM3,CCDC191,TCL1A,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,VPREB3,IGLL5 #> 3                  CD19,IgD,CD38,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,JCHAIN,SSR4,FKBP11,SEC11C,DERL3,PRDX4,IGLL5,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,CD138,CD38,VPREB3,IGLL5 #> 4        CD19,CD27,IgD,CD38,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,JCHAIN,SSR4,FKBP11,SEC11C,DERL3,PRDX4,IGLL5,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,CD138,CD38,CD27,VPREB3,IGLL5 #> 5                  CD27,IgD,CD38,CD24,CD20,MS4A1,PTPRC,PAX5,CD24,CD38,CD79A,JCHAIN,SSR4,FKBP11,SEC11C,DERL3,PRDX4,IGLL5,CD79B,TCL1A,IGLL5,HLA-DQA1,HLA-DQB1,CD138,CD38,VPREB3,IGLL5 #> 6 CD8,CD2,CD3D,CD3E,CD3G,CD3Z,CD45RA,CD62L,CD27,CD127,FOXP3,CCR7,CD45,CD8A,CD8B,CCR6,CD11b,CD30,CD6,CTLA4,IL2RA,GZMB,PTPRC,SELL,CCR7,GNLY,Trac,Ltb,Cd52,Trbc2,Shisa5,Lck,Thy1,Dapl1 #>               geneSymbolmore2    shortName #> 1                        <NA>        Pro-B #> 2                        <NA>        Pre-B #> 3                        <NA>      Naive B #> 4                        <NA>     Memory B #> 5                  CD20,MS4A1     Plasma B #> 6 CD25,CD44,CD69,HLA-DRA,CD95 Naive CD8+ T"},{"path":"https://pwwang.github.io/hitype/articles/prepare-gene-sets.html","id":"gene-sets-and-weights-trained-from-pbmc-3k-dataset","dir":"Articles","previous_headings":"Built-in gene sets","what":"Gene sets and weights trained from PBMC 3k dataset","title":"Prepare gene sets","text":"","code":"hitypedb_pbmc3k #>       cellName level geneSymbolmore2       geneSymbolmore1 #> 1            B     1                                MS4A1+ #> 2   CD14+ Mono     1                           CD14++,LYZ+ #> 3       CD8+ T     1                             CD8A+++++ #> 4           DC     1                  FCER1A+++++,CST3++++ #> 5 FCFR3A+ Mono     1                 FCGR3A+++++,MS4A7++++ #> 6  Memory CD4+     1                      IL7R++++,S100A4+ #> 7           NK     1                         GNLY++,NKG7++ #> 8 Naive CD4+ T     1                          IL7R+,CCR7++ #> 9     Platelet     1                             PPBP+++++"},{"path":"https://pwwang.github.io/hitype/articles/prepare-gene-sets.html","id":"preparing-your-own-gene-sets","dir":"Articles","previous_headings":"","what":"Preparing your own gene sets","title":"Prepare gene sets","text":"can also prepare gene sets. gene sets data.frame tab-delimited file following columns: tissueType (optional): Tissue type. One can pass tissue_type gs_prepare() filter gene sets tissue type. cellName (required): Cell type name. geneSymbolmore1 (required): Markers cell type. Multiple markers separated ,. One can use suffix + indicate marker positive marker, - indicate marker negative marker. Multiple +’s allowed indicate marker strong positive marker. Multiple -’s allowed indicate marker strong negative marker. example, CD3E+++ indicates CD3E strong positive marker, CD14--- indicates CD14 strong negative marker. geneSymbolmore2 (required): Negative markers cell type. column can empty strings. kept compatibility ScType. suffixes allowed column. marker column marker previous column suffix -. level (optional): Cell type level. level cellName. must start 1 increase 1. final cell type consists one cellName level. format cellName1,cellName2;cellName3,cellName4;... cellName current level. example, CD4 level 1, nextLevels Naive;Activated indicates CD4 followed Naive level 2 Activated level 3. nextLevels also specified Naive level 2, cellName level 3 CD4 intersection Activated cellNames level 3 Naive limited nextLevels Naive. level nextLevels empty, cellNames level cellNames next level limited nextLevels level. ! can used indicate cellNames next level excluded. example, !Naive indicates Naive excluded cellNames next level. ! character level, cellNames level excluded.","code":""},{"path":"https://pwwang.github.io/hitype/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Panwen Wang. Author, maintainer.","code":""},{"path":"https://pwwang.github.io/hitype/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang P (2023). hitype: Hierarchical high-resolution cell-type identification single-cell RNA-seq data based ScType.. R package version 0.0.2, https://pwwang.github.io/hitype/.","code":"@Manual{,   title = {hitype: Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.},   author = {Panwen Wang},   year = {2023},   note = {R package version 0.0.2},   url = {https://pwwang.github.io/hitype/}, }"},{"path":"https://pwwang.github.io/hitype/index.html","id":"hitype-","dir":"","previous_headings":"","what":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"Hierarchical high-resolution cell-type identification single-cell RNA-seq data inspired ScType.","code":""},{"path":"https://pwwang.github.io/hitype/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"Compatibility ScType Hierarchical high-resolution cell-type identification Train weights markers reference dataset Speed optimization Support R package unit tests","code":""},{"path":"https://pwwang.github.io/hitype/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"can install development version hitype like :","code":"if (!requireNamespace(\"devtools\", quietly = TRUE)) {     install.packages(\"devtools\") } devtools::install_github(\"pwwang/hitype\")"},{"path":[]},{"path":"https://pwwang.github.io/hitype/index.html","id":"prepare-the-dataset","dir":"","previous_headings":"Quick start","what":"Prepare the dataset","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"See also https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#setup--seurat-object Click expand","code":"pbmc <- pbmc3k.SeuratData::pbmc3k pbmc[[\"percent.mt\"]] <- Seurat::PercentageFeatureSet(pbmc, pattern = \"^MT-\") pbmc <- subset(pbmc, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5) pbmc <- Seurat::NormalizeData(pbmc) pbmc <- Seurat::FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000) pbmc <- Seurat::ScaleData(pbmc, features = rownames(pbmc)) pbmc <- Seurat::RunPCA(pbmc, features = Seurat::VariableFeatures(object = pbmc)) pbmc <- Seurat::FindNeighbors(pbmc, dims = 1:10) pbmc <- Seurat::FindClusters(pbmc, resolution = 0.5) #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 2638 #> Number of edges: 95927 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8728 #> Number of communities: 9 #> Elapsed time: 0 seconds pbmc <- Seurat::RunUMAP(pbmc, dims = 1:10)"},{"path":"https://pwwang.github.io/hitype/index.html","id":"use-as-a-seurat-extension","dir":"","previous_headings":"Quick start","what":"Use as a Seurat extension","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"Compared manual marked cell types: See also https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#assigning-cell-type-identity--clusters","code":"library(hitype)  # Load gene sets gs <- gs_prepare(hitypedb_pbmc3k)  # Assign cell types obj <- RunHitype(pbmc, gs)  Seurat::DimPlot(obj, group.by = \"hitype\", label = TRUE, label.box = TRUE) +   Seurat::NoLegend()"},{"path":"https://pwwang.github.io/hitype/index.html","id":"use-as-standalone-functions","dir":"","previous_headings":"Quick start","what":"Use as standalone functions","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"may see exactly assignment Seurat tutorial:","code":"scores <- hitype_score(pbmc@assays$RNA@scale.data, gs, scaled = TRUE) cell_types <- hitype_assign(pbmc$seurat_clusters, scores, gs) summary(cell_types) #> # A tibble: 9 × 4 #>   Level Cluster CellType     Score #>   <int> <fct>   <chr>        <dbl> #> 1     1 0       Naive CD4+ T 0.104 #> 2     1 1       CD14+ Mono   0.162 #> 3     1 2       Memory CD4+  0.114 #> 4     1 3       B            0.139 #> 5     1 4       CD8+ T       0.190 #> 6     1 5       FCFR3A+ Mono 0.366 #> 7     1 6       NK           0.256 #> 8     1 7       DC           0.559 #> 9     1 8       Platelet     0.973"},{"path":"https://pwwang.github.io/hitype/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Hierarchical and high-resolution cell-type identification for single-cell RNA-seq data based on ScType.","text":"https://pwwang.github.io/hitype/","code":""},{"path":"https://pwwang.github.io/hitype/reference/RunHitype.html","id":null,"dir":"Reference","previous_headings":"","what":"Run hitype_assign for a Seurat object — RunHitype","title":"Run hitype_assign for a Seurat object — RunHitype","text":"Run hitype_assign Seurat object","code":""},{"path":"https://pwwang.github.io/hitype/reference/RunHitype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run hitype_assign for a Seurat object — RunHitype","text":"","code":"RunHitype(object, ...)  # S3 method for default RunHitype(object, ...)  # S3 method for Seurat RunHitype(   object,   gs = NULL,   fallback = \"Unknown\",   threshold = 0.05,   level_weights = function(l) 1/(10^(l - 1)),   make_unique = FALSE,   slot = \"data\",   assay = NULL,   scaled = FALSE,   ... )"},{"path":"https://pwwang.github.io/hitype/reference/RunHitype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run hitype_assign for a Seurat object — RunHitype","text":"object Seurat object gs gene list prepared gs_prepare fallback fallback cell type cell type assigned threshold threshold low confidence cell type assignment cell types assigned cells scores higher threshold. (0 - 1, default 0.05) level_weights weights level hierarchy calculate final cell type score either numeric vector length equal number levels single numeric value used levels can also function takes levels input returns numeric vectors weights. make_unique Whether make cell type names unique slot slot use GetAssayData assay assay use GetAssayData scaled Whether data GetAssayData scaled","code":""},{"path":"https://pwwang.github.io/hitype/reference/RunHitype.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run hitype_assign for a Seurat object — RunHitype","text":"Seurat object cell types (named hitype) added metadata","code":""},{"path":"https://pwwang.github.io/hitype/reference/compile_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Compile the weights — compile_weights","title":"Compile the weights — compile_weights","text":"Compile weights","code":""},{"path":"https://pwwang.github.io/hitype/reference/compile_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compile the weights — compile_weights","text":"","code":"compile_weights(weights, gs, level, range)"},{"path":"https://pwwang.github.io/hitype/reference/compile_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compile the weights — compile_weights","text":"weights data frame weights gs gene sets level level gene sets range range weights","code":""},{"path":"https://pwwang.github.io/hitype/reference/compile_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compile the weights — compile_weights","text":"data frame db","code":""},{"path":"https://pwwang.github.io/hitype/reference/do_call.html","id":null,"dir":"Reference","previous_headings":"","what":"Faster version of do.call — do_call","title":"Faster version of do.call — do_call","text":"Faster version .call","code":""},{"path":"https://pwwang.github.io/hitype/reference/do_call.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Faster version of do.call — do_call","text":"","code":"do_call(what, args, quote = FALSE, envir = parent.frame())"},{"path":"https://pwwang.github.io/hitype/reference/do_call.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Faster version of do.call — do_call","text":"Gmisc","code":""},{"path":"https://pwwang.github.io/hitype/reference/do_call.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Faster version of do.call — do_call","text":"function call args arguments pass function quote Whether quote arguments envir environment look function parent frame","code":""},{"path":"https://pwwang.github.io/hitype/reference/do_call.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Faster version of do.call — do_call","text":"results using .call()","code":""},{"path":"https://pwwang.github.io/hitype/reference/do_call.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Faster version of do.call — do_call","text":"Max Gordon","code":""},{"path":"https://pwwang.github.io/hitype/reference/explode.html","id":null,"dir":"Reference","previous_headings":"","what":"Split the string by the separator and trim the whitespaces. — explode","title":"Split the string by the separator and trim the whitespaces. — explode","text":"Split string separator trim whitespaces.","code":""},{"path":"https://pwwang.github.io/hitype/reference/explode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split the string by the separator and trim the whitespaces. — explode","text":"","code":"explode(x, sep = \",\")"},{"path":"https://pwwang.github.io/hitype/reference/explode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split the string by the separator and trim the whitespaces. — explode","text":"x string. sep separator.","code":""},{"path":"https://pwwang.github.io/hitype/reference/explode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split the string by the separator and trim the whitespaces. — explode","text":"character vector.","code":""},{"path":"https://pwwang.github.io/hitype/reference/gs_prepare.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare gene sets for hitype — gs_prepare","title":"Prepare gene sets for hitype — gs_prepare","text":"Prepare gene sets hitype","code":""},{"path":"https://pwwang.github.io/hitype/reference/gs_prepare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare gene sets for hitype — gs_prepare","text":"","code":"gs_prepare(path_to_db_file, tissue_type = NULL)"},{"path":"https://pwwang.github.io/hitype/reference/gs_prepare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare gene sets for hitype — gs_prepare","text":"path_to_db_file data frame markers Path marker gene database file, tab-delimited text excel file following columns: tissueType: tissue type cell type annotated. column required cell_type specified. cellName: name cell type annotated. nextLevels: Possible next levels cell type annotated. Introduced hitype, can work hierarchical cell. Levels separated ;. Cell names level separated ,. exclamatory mark ! beginning level means cell names level mutually exclusive. levels less possible next levels, remaining levels possible next levels. See example . geneSymbolmore1: gene symbols marker genes expected expressed cell type annotated. genes can suffixed one +. + means higher expression level. example, CD3E++ means gene CD3E expected highly expressed cell type. geneSymbolmore2: gene symbols marker genes expected expressed cell type annotated. level: levels cell names. Introduced hitype, can work hierarchical cell names. Different levels cellNames predicted separately. example, CD4 level 1 Naive level 2, prediction cell type CD4 Naive. levels start 1 consecutive. #' tissue_type tissue type cell type annotated. requires tissueType column marker gene database file. tissue_type specified, cell types specified tissue type used annotation. tissue_type specified, cell types marker gene database file used annotation.","code":""},{"path":"https://pwwang.github.io/hitype/reference/gs_prepare.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare gene sets for hitype — gs_prepare","text":"list gene_sets next_levels. structure looks like:","code":"list(      gene_sets = list(          # level 1          list( CD4 = list(markers = c(...), weights = c(...)), ... ),          # level 2          list( Naive = list(markers = c(...), weights = c(...)), ... )      ),      # All possible final cell names      cell_names = list(CD4 = list(Naive = c(\"Activated\", \"Proliferating\")))   )"},{"path":"https://pwwang.github.io/hitype/reference/gs_prepare.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Prepare gene sets for hitype — gs_prepare","text":"Matt Mulvahill, Panwen Wang","code":""},{"path":"https://pwwang.github.io/hitype/reference/gs_prepare.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare gene sets for hitype — gs_prepare","text":"","code":"# nextLevels example # If we have the following cell types: #   level  cellName  nextLevels #   1      CD4       Naive,Memory #   2      Naive #   2      Memory #   3      Activated #   3      Proliferating # Then possible final cell names are: #   CD4 Naive Activated #   CD4 Naive Proliferating #   CD4 Memory Activated #   CD4 Memory Proliferating # # If the `nextLevels` of CD4 is `!Naive`, then possible final cell names are: #   CD4 Memory Activated #   CD4 Memory Proliferating # # If the `nextLevels` of CD4 is `!`, then possible final cell names are: #   CD4 Activated #   CD4 Proliferating # # If the `nextLevels` of CD4 is `!Naive;!`, then possible final cell names # are: #   CD4 Memory"},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate scores for cell types for each level — hitype_assign","title":"Generate scores for cell types for each level — hitype_assign","text":"Generate scores cell types level","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate scores for cell types for each level — hitype_assign","text":"","code":"hitype_assign(   clusters,   scores,   gs = NULL,   fallback = \"Unknown\",   threshold = 0.05,   top = 10 )"},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate scores for cell types for each level — hitype_assign","text":"clusters named vector original cluster assignments (names - cell names, values - cluster assignments) scores list matrices cell type scores level gs gene sets prepared gs_prepare cell_names actually used. One also pass gs$cell_names directly. fallback fallback cell type cell type assigned threshold threshold low confidence cell type assignment cell types assigned cells scores higher threshold * ncells. (0 - 1, default 0.05) top number top cell types assign cluster result.","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate scores for cell types for each level — hitype_assign","text":"dataframe columns: Level, Cluster, CellType Score. level cluster, top cell types returned. can use summary.hitype_result print combination cell types cluster.","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign cell types based on ScType scores — hitype_assign_level","title":"Assign cell types based on ScType scores — hitype_assign_level","text":"Assign cell types based ScType scores","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign cell types based on ScType scores — hitype_assign_level","text":"","code":"hitype_assign_level(clusters, scores, threshold, top = 10)"},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign cell types based on ScType scores — hitype_assign_level","text":"clusters named vector original cluster assignments (names - cell names, values - cluster assignments) scores list matrices cell type scores level threshold threshold low confidence cell type assignment cell types assigned cells scores higher threshold * ncells. (0 - 1, default 0.05) top number top cell types assign cluster","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_assign_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign cell types based on ScType scores — hitype_assign_level","text":"data top cell type assignments","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate cell type scores — hitype_score","title":"Calculate cell type scores — hitype_score","text":"Calculate cell type scores","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate cell type scores — hitype_score","text":"","code":"hitype_score(exprs, gs, scaled = FALSE)"},{"path":"https://pwwang.github.io/hitype/reference/hitype_score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate cell type scores — hitype_score","text":"exprs Input scRNA-seq data matrix (rownames - gene names, colnames - cell names) gs gene sets prepared gs_prepare gene_sets used. One also pass gs$gene_sets directly. scaled Whether input data scaled ","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate cell type scores — hitype_score","text":"list matrices cell type scores level (rownames - cell types, colnames - cell names)","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate cell type scores — hitype_score","text":"Matt Mulvahill, Panwen Wang","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate ScType scores and assign cell types for one level — hitype_score_level","title":"Calculate ScType scores and assign cell types for one level — hitype_score_level","text":"Calculate ScType scores assign cell types one level","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate ScType scores and assign cell types for one level — hitype_score_level","text":"","code":"hitype_score_level(z, gs_level)"},{"path":"https://pwwang.github.io/hitype/reference/hitype_score_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate ScType scores and assign cell types for one level — hitype_score_level","text":"z Z-scaled expression matrix (rownames - gene names, colnames - cell names) gs_level One level gene sets prepared gs_prepare","code":""},{"path":"https://pwwang.github.io/hitype/reference/hitype_score_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate ScType scores and assign cell types for one level — hitype_score_level","text":"matrix cell type scores cell (rownames - cell types, colnames - cell names)","code":""},{"path":"https://pwwang.github.io/hitype/reference/n_ending.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the number of repetitive given ending characters. — n_ending","title":"Get the number of repetitive given ending characters. — n_ending","text":"Get number repetitive given ending characters.","code":""},{"path":"https://pwwang.github.io/hitype/reference/n_ending.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the number of repetitive given ending characters. — n_ending","text":"","code":"n_ending(x, ending)"},{"path":"https://pwwang.github.io/hitype/reference/n_ending.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the number of repetitive given ending characters. — n_ending","text":"x string. ending ending character.","code":""},{"path":"https://pwwang.github.io/hitype/reference/n_ending.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the number of repetitive given ending characters. — n_ending","text":"number ending character.","code":""},{"path":"https://pwwang.github.io/hitype/reference/parse_next_imm_levels.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse next immediate levels of cell types — parse_next_imm_levels","title":"Parse next immediate levels of cell types — parse_next_imm_levels","text":"Parse next immediate levels cell types","code":""},{"path":"https://pwwang.github.io/hitype/reference/parse_next_imm_levels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse next immediate levels of cell types — parse_next_imm_levels","text":"","code":"parse_next_imm_levels(nl_marks, all_next_levels)"},{"path":"https://pwwang.github.io/hitype/reference/parse_next_imm_levels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse next immediate levels of cell types — parse_next_imm_levels","text":"nl_marks marks next levels cell types all_next_levels possible next levels cell types","code":""},{"path":"https://pwwang.github.io/hitype/reference/parse_next_imm_levels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse next immediate levels of cell types — parse_next_imm_levels","text":"vector possible next immediate levels cell types","code":""},{"path":"https://pwwang.github.io/hitype/reference/parse_next_levels.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse all next levels of current cell name — parse_next_levels","title":"Parse all next levels of current cell name — parse_next_levels","text":"Parse next levels current cell name","code":""},{"path":"https://pwwang.github.io/hitype/reference/parse_next_levels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse all next levels of current cell name — parse_next_levels","text":"","code":"parse_next_levels(   cell_name,   level,   max_level,   nl_marks,   cell_markers,   next_imm_levels )"},{"path":"https://pwwang.github.io/hitype/reference/parse_next_levels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse all next levels of current cell name — parse_next_levels","text":"cell_name current cell name level current level max_level max level nl_marks next level marks cell_markers cell markers data frame next_imm_levels next immediate levels","code":""},{"path":"https://pwwang.github.io/hitype/reference/parse_next_levels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse all next levels of current cell name — parse_next_levels","text":"list possible cell names","code":""},{"path":"https://pwwang.github.io/hitype/reference/prepare_data_for_training.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare the data for weight training — prepare_data_for_training","title":"Prepare the data for weight training — prepare_data_for_training","text":"Prepare data weight training","code":""},{"path":"https://pwwang.github.io/hitype/reference/prepare_data_for_training.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare the data for weight training — prepare_data_for_training","text":"","code":"prepare_data_for_training(   path_to_gs,   exprs,   level = 1,   scaled = FALSE,   clusters = NULL )"},{"path":"https://pwwang.github.io/hitype/reference/prepare_data_for_training.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare the data for weight training — prepare_data_for_training","text":"path_to_gs Path gene set file without weights exprs expression matrix, seurat object (rows: genes, columns: samples/cells) level level gene sets train weights multiple levels gene sets. scaled Whether expression matrix scaled clusters named vector cluster ids exprs seurat object, ignored. cluster ids taken seurat object.","code":""},{"path":"https://pwwang.github.io/hitype/reference/prepare_data_for_training.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare the data for weight training — prepare_data_for_training","text":"list gene sets, z matrix clusters","code":""},{"path":"https://pwwang.github.io/hitype/reference/print.hitype_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the summary of the hitype_result object — print.hitype_result","title":"Print the summary of the hitype_result object — print.hitype_result","text":"Print summary hitype_result object","code":""},{"path":"https://pwwang.github.io/hitype/reference/print.hitype_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the summary of the hitype_result object — print.hitype_result","text":"","code":"# S3 method for hitype_result print(   hitype_res,   top = 1,   level_weights = function(l) 1/(2^(l - 1)),   make_unique = FALSE,   ... )"},{"path":"https://pwwang.github.io/hitype/reference/print.hitype_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the summary of the hitype_result object — print.hitype_result","text":"top top assigned cell types return cluster level_weights weights level hierarchy calculate final cell type score either numeric vector length equal number levels single numeric value used levels can also function takes levels input returns numeric vectors weights. make_unique Whether make cell type names unique ... Additional arguments pass print","code":""},{"path":"https://pwwang.github.io/hitype/reference/print.hitype_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print the summary of the hitype_result object — print.hitype_result","text":"summary hitype_result object","code":""},{"path":"https://pwwang.github.io/hitype/reference/revert_cell_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove the suffix of the cell name. — revert_cell_name","title":"Remove the suffix of the cell name. — revert_cell_name","text":"Remove suffix cell name.","code":""},{"path":"https://pwwang.github.io/hitype/reference/revert_cell_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove the suffix of the cell name. — revert_cell_name","text":"","code":"revert_cell_name(cell_name)"},{"path":"https://pwwang.github.io/hitype/reference/revert_cell_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove the suffix of the cell name. — revert_cell_name","text":"cell_name cell name.","code":""},{"path":"https://pwwang.github.io/hitype/reference/revert_cell_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove the suffix of the cell name. — revert_cell_name","text":"cell name without suffix.","code":""},{"path":"https://pwwang.github.io/hitype/reference/run_weights_on_test_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Run compiled weights on test data — run_weights_on_test_data","title":"Run compiled weights on test data — run_weights_on_test_data","text":"Run compiled weights test data","code":""},{"path":"https://pwwang.github.io/hitype/reference/run_weights_on_test_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run compiled weights on test data — run_weights_on_test_data","text":"","code":"run_weights_on_test_data(db, exprs, clusters, scaled, test_data_idx)"},{"path":"https://pwwang.github.io/hitype/reference/run_weights_on_test_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run compiled weights on test data — run_weights_on_test_data","text":"db weights data frame exprs expression matrix, seurat object (rows: genes, columns: samples/cells) clusters named vector cluster ids exprs seurat object, ignored. cluster ids taken seurat object. scaled Whether expression matrix scaled test_data_idx row names test data","code":""},{"path":"https://pwwang.github.io/hitype/reference/summary.hitype_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize the hitype_result object — summary.hitype_result","title":"Summarize the hitype_result object — summary.hitype_result","text":"Summarize hitype_result object","code":""},{"path":"https://pwwang.github.io/hitype/reference/summary.hitype_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize the hitype_result object — summary.hitype_result","text":"","code":"# S3 method for hitype_result summary(   hitype_res,   top = 1,   level_weights = function(l) 1/(2^(l - 1)),   make_unique = FALSE )"},{"path":"https://pwwang.github.io/hitype/reference/summary.hitype_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize the hitype_result object — summary.hitype_result","text":"top top assigned cell types return cluster level_weights weights level hierarchy calculate final cell type score either numeric vector length equal number levels single numeric value used levels can also function takes levels input returns numeric vectors weights. make_unique Whether make cell type names unique","code":""},{"path":"https://pwwang.github.io/hitype/reference/summary.hitype_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize the hitype_result object — summary.hitype_result","text":"summary hitype_result object","code":""},{"path":"https://pwwang.github.io/hitype/reference/train_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Train weights for the markers — train_weights","title":"Train weights for the markers — train_weights","text":"Train weights markers","code":""},{"path":"https://pwwang.github.io/hitype/reference/train_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Train weights for the markers — train_weights","text":"","code":"train_weights(   path_to_gs,   exprs,   level = 1,   scaled = FALSE,   clusters = NULL,   range = c(1, 5),   data_split = c(0.7, 0.2, 0.1),   epochs = 20,   batch_size = 32,   run_weights_on_test = TRUE )"},{"path":"https://pwwang.github.io/hitype/reference/train_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Train weights for the markers — train_weights","text":"path_to_gs Path gene set file without weights exprs expression matrix, seurat object (rows: genes, columns: samples/cells) level level gene sets train weights multiple levels gene sets. scaled Whether expression matrix scaled clusters named vector cluster ids exprs seurat object, ignored. cluster ids taken seurat object. range range weights data_split vector fractions training, validation testing. two fractions provided, testing set used. epochs number epochs train batch_size batch size run_weights_on_test Whether run weights test set. Requires data_split three elements.","code":""},{"path":"https://pwwang.github.io/hitype/reference/train_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Train weights for the markers — train_weights","text":"data frame weights, can used directly gs_prepare.","code":""},{"path":"https://pwwang.github.io/hitype/reference/valid_cell_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the valid cell type for a given cell type — valid_cell_type","title":"Get the valid cell type for a given cell type — valid_cell_type","text":"Get valid cell type given cell type","code":""},{"path":"https://pwwang.github.io/hitype/reference/valid_cell_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the valid cell type for a given cell type — valid_cell_type","text":"","code":"valid_cell_type(cell_type, gs)"},{"path":"https://pwwang.github.io/hitype/reference/valid_cell_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the valid cell type for a given cell type — valid_cell_type","text":"cell_type vector cell types, length number cell type levels gs list cell names cell type level","code":""},{"path":"https://pwwang.github.io/hitype/reference/valid_cell_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the valid cell type for a given cell type — valid_cell_type","text":"string valid cell types NULL cell type invalid","code":""},{"path":"https://pwwang.github.io/hitype/news/index.html","id":"version-002","dir":"Changelog","previous_headings":"","what":"Version 0.0.2","title":"Version 0.0.2","text":"Add logo Reduce keras requirement 2.11","code":""},{"path":"https://pwwang.github.io/hitype/news/index.html","id":"version-001","dir":"Changelog","previous_headings":"","what":"Version 0.0.1","title":"Version 0.0.1","text":"Add make_unique RunHitype","code":""},{"path":"https://pwwang.github.io/hitype/news/index.html","id":"version-000","dir":"Changelog","previous_headings":"","what":"Version 0.0.0","title":"Version 0.0.0","text":"Initial release","code":""}]
